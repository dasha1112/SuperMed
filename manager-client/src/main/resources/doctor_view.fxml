<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.Separator?>

<?import javafx.scene.layout.Region?>
<BorderPane xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.supermed.DoctorController">

    <top>
        <VBox spacing="5" style="-fx-padding: 10; -fx-background-color: #ecf0f1;">
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Label text="SuperMed - Панель врача" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="userInfoLabel" style="-fx-font-weight: bold;"/>
                <Button text="Выход" onAction="#handleLogout"
                        style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold;"/>
            </HBox>
            <Separator/>
            <Label fx:id="statusLabel" style="-fx-font-size: 12px;"/>
        </VBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE">

            <!-- Вкладка 1: Мое расписание (приемы пациентов) -->
            <Tab fx:id="scheduleTab" text="Мои приемы">
                <VBox spacing="10" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Дата:" style="-fx-font-weight: bold;"/>
                        <DatePicker fx:id="datePicker" prefWidth="120"/>

                        <Label text="Показать:" style="-fx-font-weight: bold; -fx-padding: 0 0 0 10;"/>
                        <ComboBox fx:id="viewTypeComboBox" prefWidth="100"/>

                        <Button fx:id="todayButton" text="Сегодня" onAction="#handleShowToday"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold;"/>
                        <Button fx:id="weekButton" text="Неделя" onAction="#handleShowWeek"
                                style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-font-weight: bold;"/>
                        <Button fx:id="refreshScheduleButton" text="Обновить" onAction="#handleRefreshScheduleTab"
                                style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold;"/>

                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="scheduleStatsLabel" style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                    </HBox>

                    <TableView fx:id="scheduleTableView" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="scheduleDateCol" text="Дата" prefWidth="100"/>
                            <TableColumn fx:id="scheduleTimeCol" text="Время" prefWidth="120"/>
                            <TableColumn fx:id="schedulePatientCol" text="Пациент" prefWidth="150"/>
                            <TableColumn fx:id="scheduleTypeCol" text="Тип приема" prefWidth="100"/>
                            <TableColumn fx:id="scheduleStatusCol" text="Статус" prefWidth="100"/>
                            <TableColumn fx:id="scheduleActionsCol" text="Действие" prefWidth="120"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

            <!-- Вкладка 2: Рабочее расписание (когда врач работает) -->
            <Tab text="Мое рабочее расписание">
                <VBox spacing="10" style="-fx-padding: 15;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="График работы" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="refreshWorkScheduleButton" text="Обновить" onAction="#refreshWorkSchedule"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold;"/>
                        <Label fx:id="workScheduleLabel" style="-fx-font-weight: bold;"/>
                    </HBox>

                    <TableView fx:id="workScheduleTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colDayOfWeek" text="День недели" prefWidth="150"/>
                            <TableColumn fx:id="colWorkHours" text="Часы работы" prefWidth="150"/>
                            <TableColumn fx:id="colBranch" text="Филиал" prefWidth="200"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>

                    <!-- Информационная панель -->
                    <VBox spacing="5" style="-fx-padding: 10; -fx-background-color: #f8f9fa; -fx-border-color: #dee2e6; -fx-border-width: 1; -fx-border-radius: 5;">
                        <Label text="Информация о графике:" style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <Label text="• Рабочие дни выделены цветом"/>
                        <Label text="• Выходные дни отмечены красным"/>
                        <Label text="• Нажмите 'Обновить' для актуального графика"/>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Вкладка 3: Сообщения -->
            <Tab text="Сообщения">
                <HBox spacing="10" style="-fx-padding: 15;">
                    <VBox spacing="10" prefWidth="300">
                        <Label text="Диалоги с пациентами:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <ListView fx:id="conversationListView" VBox.vgrow="ALWAYS"/>
                        <Button text="Обновить диалоги" onAction="#loadConversations"
                                style="-fx-background-color: #3498db; -fx-text-fill: white;"/>
                    </VBox>

                    <VBox spacing="10" HBox.hgrow="ALWAYS">
                        <Label fx:id="currentConversationLabel" text="Выберите диалог"
                               style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <TextArea fx:id="messageHistoryArea" VBox.vgrow="ALWAYS"
                                  editable="false" wrapText="true"/>

                        <HBox spacing="5">
                            <TextField fx:id="messageInput" HBox.hgrow="ALWAYS"
                                       promptText="Введите сообщение..."/>
                            <Button text="Отправить" onAction="#sendMessage"
                                    style="-fx-background-color: #2ecc71; -fx-text-fill: white;"/>
                        </HBox>
                    </VBox>
                </HBox>
            </Tab>

        </TabPane>
    </center>

</BorderPane>